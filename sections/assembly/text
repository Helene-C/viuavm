\section{begin}

This section is a reference for Viua VM assembly language.
It discusses source code organisation, compilation units, syntax, etc.
Reading this section may allow you to undesrtand the SYNTAX and EXAMPLES sections in
documentation for each instruction.

\heading{DIRECTIVES}
\section{begin}

\heading{BLOCK}

`.block:' directive begins a block definition.
Block definitions must end with the `.end' directive.

\heading{BSIGNATURE}

`.bsignature:' declares that a block will be available at link time, even if it is an unresolved symbol in the
current compilation unit.

\heading{FUNCTION}

`.function:' directive begins a function definition.
Function definitions must end with the `.end' directive.

\heading{SIGNATURE}

`.signature:' declares that a function will be available at link time, even if it is an unresolved symbol in the
current compilation unit.

\heading{CLOSURE}

`.closure:' directive begins a closure definition.
Closure definitions must end with the `.end' directive.

\heading{INFO}

`.info:' directive allows adding metadata to the produced binary.

\heading{IOTA}

`.iota:' directive sets the next value to be used for the `iota' symbol substitution.

\heading{IMPORT}

`.import:' directive requests that a module be statically linked to the currently compiled executable.

\heading{MARK}

`.mark:' directive sets a name for a point in a block, closure, or function body.
This name then may be used instead of an instruction index in branching instructions.
Marks are a compile-time-only feature and disappear after the source code has been converted to bytecode.
At runtime the VM uses only bytecode indexes, not marks.

NOTE FIXME
\break
\indent{2}
The assembler is currently unable to encode markers in bytecode, even as a debugging aid.
This is a deficiency that will be fixed in the future.
\dedent{2}

\heading{NAME}

`.name:' directive sets a name for a register.
Names are present only during compilation, and disappear after the source code has been converted to bytecode.
At runtime the VM uses only indexes, not names.

NOTE FIXME
\break
\indent{2}
The assembler is currently unable to encode register names in bytecode, even as a debugging aid.
This is a deficiency that will be fixed in the future.
\dedent{2}

\heading{END}

`.end' directive is used to signal an end of a previously opened directive that requires closing.
An example of such a directive is `.function:'.


\section{end}

\heading{FUNCTIONS}
\section{begin}

This section talks about functions.
All code in Viua VM programs is contained in functions, therefore it is incredibly important
to understand them.

\heading{DEFINITIONS}
\section{begin}

This section talks about how to define functions.

\heading{DELIMITING FUNCTION BODIES}
\section{begin}

How function bodies are delimited.

\section{end}

\heading{PARAMETERS}
\section{begin}

How to get parameters to functions.

\section{end}

\heading{RETURN VALUES}
\section{begin}

How to return values from functions.

\section{end}

\section{end}

\heading{DECLARATIONS}
\section{begin}

How to declare that a function will be available during linking, and
that the assembler should just trust us that it exists.

\section{end}

\section{end}

\heading{REGISTER NAMING}
\section{begin}

How to name registers with human-readable names, e.g. `index' or `size', instead of bare
indexes - `1', `4', etc.

\section{end}

\section{end}
